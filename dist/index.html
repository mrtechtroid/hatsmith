<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet">
    <title>Hat.sh v2.0 Beta!</title>
  </head>
  <body>
    
    <div id="overlay"></div>
    <!--start main container-->
    <div class="container d-flex h-100 flex-column">

        <!--start header-->
        <header class="d-flex flex-column flex-md-row align-items-center p-4 mb-4">
            <a href="/" class="d-flex align-items-center text-dark text-decoration-none">
            <img src="icon.png" width="50" />
            </a>

            <nav class="d-inline-flex mt-2 mt-md-0 ms-md-auto">
            <!-- <a class="me-4 py-2 text-gray text-decoration-none" href="#">about</a> -->
            <a class="me-4 py-2 text-gray text-decoration-none" href="https://hat.sh" target="_blank">v1</a>
            <a class="py-2 text-gray text-decoration-none" href="https://github.com/sh-dv/hat.sh/tree/v2-beta" target="_blank">github</a>
            </nav>
        </header>
        <!--end header-->


    <!-- start hero -->
    <div class="px-4 mb-4 text-center text-gray">
        <h4 class="">Hat.sh v2.0 beta is here 👋</h4>
        <div class="col-lg-6 mx-auto">
          <p class="mb-4">A Free, Fast, Secure and Local File Encryption</p>
          <div class="justify-content-sm-center">
            <button type="button" class="btn btn-black mb-3" data-bs-toggle="modal" data-bs-target="#whatsNewModal">
              What's new?
            </button>
          </div>
          <hr class="mx-auto" size="2px"/>
        </div>
      </div>
      <!-- end hero -->


      <!-- start child container -->
    <div class="container" style="max-width: 768px">

        <!-- pills ul -->
        <ul class="nav nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="encryption-pill-tab" data-bs-toggle="pill" data-bs-target="#encryption-pill" type="button" role="tab" aria-controls="encryption-pill" aria-selected="true">
              Encryption
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="decryption-pill-tab" data-bs-toggle="pill" data-bs-target="#decryption-pill" type="button" role="tab" aria-controls="decryption-pill" aria-selected="false">
              Decryption
            </button>
          </li>
        </ul>
        <!-- end pills ul -->

        <!-- start panels -->
        <div class="tab-content" id="pills-tabContent">
            
            <!-- start encryption panel -->
            <div class="tab-pane fade show active" id="encryption-pill" role="tabpanel" aria-labelledby="encryption-pill-tab">
                
                <!-- start wrapper -->
                <div class="wrapper p-3" id="encFileWrapper">
                      
                  <div class="file-area" id="encFileArea">
                      <div class="file-icon"><i class="fas fa-file-alt"></i></div>
                      <h5 id="encFileAreaText">choose a file to encrypt</h5>
                      <div class="file-area-info text-center" id="encFileAreaInfo"></div>

                      <button type="button" class="btn btn-black-light file-browse mt-3" id="encFileBrowseBtn">
                        Browse File
                      </button>

                      <input type="file" id="encFileInput" hidden/>
                  </div>
                    
                    <!-- start password generation -->
                    <div class="row mt-4 px-3 " id="encPasswordField" style="display: none;">
                        <div class="co-sm-10 col-10">
                            <input type="text" id="encPasswordInput" class="form-control password-input" placeholder="Enter a password or generate one">
                        </div>
                        <button class="btn btn-black-light col-sm-2 col-2" id="generatePasswordBtn" type="button"><i class="fas fa-sync-alt"></i></button>
                    </div>
                    <!-- end password generation -->

                </div>
                <!-- end wrapper -->

                <!-- start encryption request button -->
                <div class="d-grid gap-2 mt-3" >
                    <button class="btn btn-black" type="button" id="encRequestBtn" style="display: none;">
                      Encrypt
                    </button>
                </div>
                <!-- end encryption request button -->


            </div>
            <!-- end encryption panel -->



            <!-- start decryption panel -->
            <div class="tab-pane fade" id="decryption-pill" role="tabpanel" aria-labelledby="decryption-pill-tab">
                
              <!-- start wrapper -->
                <div class="wrapper p-3" id="decFileWrapper">
                      
                  <div class="file-area" id="decFileArea">
                      <div class="file-icon"><i class="fas fa-file-alt"></i></div>
                      <h5 id="decFileAreaText">choose a file to decrypt</h5>
                      <div class="file-area-info text-center" id="decFileAreaInfo"></div>

                      <button type="button" class="btn btn-black-light file-browse mt-3" id="decFileBrowseBtn">
                        Browse File
                      </button>

                      <input type="file" id="decFileInput" hidden/>
                  </div>
                    
                    <!-- start password field -->
                    <div class="row mt-4 px-3 " id="decPasswordField" style="display: none;">
                        <div class="co-sm-auto">
                            <input type="text" id="decPasswordInput" class="form-control password-input" placeholder="Enter decryption password">
                        </div>
                    </div>
                    <!-- end password field -->

                </div>
                <!-- end wrapper -->                 

                <!-- start decryption request button -->
                <div class="d-grid gap-2 mt-3" >
                    <button class="btn btn-black" type="button" id="decRequestBtn" style="display: none;">
                      Decrypt
                    </button>
                    <button class="btn btn-black" type="button" id="decPasswordCheckBtn" style="display: none;" disabled >
                      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                      Checking Password...
                    </button>
                </div>
                <!-- end decryption request button -->

            </div>
            <!-- end decryption panel -->

            <!-- start error alerts section -->
            <div class="d-grid gap-2 mt-3" id="errorArea">
              
            </div>
            <!-- end error alerts section -->

        </div>
        <!-- end panels -->

    </div>
    <!-- end child container -->

    <!-- start footer -->
    <footer class="mastfoot mt-auto pt-5 text-center">
        <div class="inner">
            <p>built and developed with <i class="fa fa-heart" style="color: #e74c3c"></i> by<a href="https://github.com/sh-dv" target="_blank" class="text-dark"> sh-dv.</a>
                <br />
                <a href="bitcoin:bc1qh0lmuj34h2z4kr7j2sx8fegqvvaj35ycdtglw2" style="background-color: #ebebeb; color: #9791a1">bc1qh0lmuj34h2z4kr7j2sx8fegqvvaj35ycdtglw2</a>
            </p>
        </div>
    </footer>
    <!-- end footer -->

    </div>
    <!--end main container-->



        <!--whats new Modal -->
        <div class="modal fade" id="whatsNewModal" tabindex="-1" aria-labelledby="whatsNewModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
              <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="whatsNewModalLabel">what's new?</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
  
              <div class="modal-body">
  
                  <strong>Memory efficient large file chunked encryption using streams with libsodium.js 🎉</strong>
                  <p class="mt-3">
                  - switching to <code>xchacha20poly1305</code> for symmetric stream encryption and <code>Argon2id</code> for password-based key derivation. instead of AES-256-GCM and PBKDF2.
                  </p>
  
                  <p class="mt-3">
                  - using the libsodium library for all cryptography instead of the WebCryptoApi.
                  </p>
  
                  <strong>How this new version is different?</strong>
                  <p class="mt-3">
                  - in this version, the app doesn't read the whole file in memory. instead, it's sliced into 64MB chunks that are processed ony by one.
                  </p>
                  
                  <p class="mt-3">
                  - since we are not using any server-side processing, the app registers a fake download URL <code>(/file)</code> that is going to be handled by the service-worker fetch api.
                  </p>
  
                  <p class="mt-3">
                  - if all validations are passed, a new stream is initialized. then, file chunks are transferred from the main app to the service-worker file via messages.
                  </p>
  
                  <p class="mt-3">
                  - each chunk is encrypted/decrypted on it's own and added to the stream.
                  </p>
  
                  <p class="mt-3">
                  - after each chunk is written on disk it is going to be immediately garbage collected by the browser, this leads to never having more than a few chunks in the memory at the same time.
                  </p>
  
                  <strong>ToDos 👨‍💻 :</strong>
  
                  <p class="mt-3">
                  - add support to safari and mobile browsers (next week)
                  <br>
                  - handle stream back pressures.
                  <br>
                  - improve ui (switching to ReactJs and tailwindcss upon release).
                  </p>
  
                  <strong>projected release date : 1/9/2021</strong>
  
              </div>
  
              <div class="modal-footer got-it" >
                  <div class="d-grid gap-2">
                  <button type="button" class="btn btn-black" data-bs-dismiss="modal">
                      got it 👍
                  </button>
                  </div>
              </div>
              </div>
          </div>
          </div>
      <!--end modal-->
  
  
    
  <!-- supported modal -->
  <div
  class="modal fade"
  id="supportModal"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="supportModalLabel"
  aria-hidden="true"
  >
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="supportModalLabel"></h5>
        <button type="button" class="btn-close" id="supportModalCloseBtn" data-bs-dismiss="modal" aria-label="Close"></button> 
      </div>
      <div class="modal-body bg-white">
        <div class="icon-box">
          <div class="icon"><i class="fas fa-exclamation-circle" style="color: #000; background-color: #f2f2f2;"></i></div>
          <h4 class="title">Browser Not Supported!</h4>
          <p class="description text-muted">
            <strong style="color: rgb(74, 85, 104)"></strong>
            Browser not yet supported for this beta. please try it using <strong>chrome</strong> or <strong>firefox</strong> on desktop, or check us out later.
          </p>
        </div>
      </div>
    </div>
  </div>
  </div>
  <!-- end supported modal -->
  
  
  <!-- enc modal -->
        <div
        class="modal fade"
        id="encModal"
        data-bs-backdrop="static"
        data-bs-keyboard="false"
        tabindex="-1"
        aria-labelledby="encryptModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="encryptModalLabel"></h5>
              <button
                type="button"
                class="btn-close"
                id="encModalCloseBtn"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body bg-white">
              <div class="icon-box">
                <div class="icon"><i class="fas fa-lock"></i></div>
                <h4 class="title">Success!</h4>
                <p class="description text-muted">
                  <strong style="color: rgb(74, 85, 104)" id="encModalFileName"></strong>
                  was loaded successfully and ready to be encrypted & downloaded!
                </p>
              </div>
            </div>
            <div class="modal-footer p-3">
              <div class="mx-auto">
                <button type="button" class="btn btn-light" id="copyPassword">
                  <i class="fas fa-copy"></i> <span id="copyPasswordTitle">Decryption Password</span> 
                </button>
                <span id="copyPasswordInput"></span>
                <a id="encBtn" class="btn btn-purple"> <i class="fas fa-download"></i> Encrypted File</a>
  
              </div>
            </div>
          </div>
        </div>
      </div>
  <!-- end enc modal -->
  
  <!-- dec modal -->
  <div
  class="modal fade"
  id="decModal"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="decryptModalLabel"
  aria-hidden="true"
  >
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="decryptModalLabel"></h5>
        <button
          type="button"
          class="btn-close"
          id="decModalCloseBtn"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body bg-white">
        <div class="icon-box">
          <div class="icon"><i class="fas fa-unlock"></i></div>
          <h4 class="title">Success!</h4>
          <p class="description text-muted">
            <strong style="color: rgb(74, 85, 104)" id="decModalFileName"></strong>
            was loaded successfully and ready to be decrypted & downloaded!
          </p>
        </div>
      </div>
      <div class="modal-footer p-3">
        <div class="mx-auto">
  
          <a id="decBtn" class="btn btn-purple"> <i class="fas fa-download"></i> Decrypted File</a>
  
        </div>
      </div>
    </div>
  </div>
  </div>
  <!-- end dec modal -->
  

    <script src="build.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
  </body>
</html>
